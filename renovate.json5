{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "config:recommended",
    "docker:enableMajor",
    "helpers:pinGitHubActionDigests",
    ":automergeBranch",
    ":dependencyDashboard",
    ":semanticCommits",
    ":timezone(Europe/Warsaw)",
  ],
  dependencyDashboardTitle: "Renovate Dashboard ðŸ¤–",
  suppressNotifications: [
    "prEditedNotification",
    "prIgnoreNotification",
  ],
  ignorePaths: [
    "**/*.sops.yaml",
    "**/*.sops.yml",
    "**/*.sops.json",
    "**/*.sops.*",
    "**/secret.sops.yaml",
  ],
  flux: {
    managerFilePatterns: ["/^kubernetes/.+\\.ya?ml$/"],
  },
  "helm-values": {
    managerFilePatterns: ["/^kubernetes/.+\\.ya?ml$/"],
  },
  kubernetes: {
    managerFilePatterns: ["/^kubernetes/.+\\.ya?ml$/"],
  },
  customManagers: [
    {
      customType: "regex",
      description: "Track Kind node images used by bootstrap",
      fileMatch: ["^bootstrap/cluster-config\\.yaml$"],
      matchStrings: [
        "image:\\s*(?<depName>kindest/node):(?<currentValue>[0-9A-Za-z_.-]+)",
      ],
      datasourceTemplate: "docker",
    },
  ],
  packageRules: [
    {
      description: "Treat Kind node tags as loose versions",
      matchDatasources: ["docker"],
      matchPackageNames: ["kindest/node"],
      versioning: "loose",
    },
    {
      description: "Group Kind cluster node updates into a single PR",
      matchFileNames: ["bootstrap/cluster-config.yaml"],
      groupName: "kind-nodes",
    },
    {
      description: "Auto-merge all non-major dependency updates",
      automerge: true,
      automergeType: "branch",
      matchUpdateTypes: ["minor", "patch", "digest", "pin", "rollback"],
      ignoreTests: true,
    },
    {
      description: "Require manual review for major upgrades",
      automerge: false,
      matchUpdateTypes: ["major"],
      addLabels: ["renovate/manual-review"],
    },
  ],
}
