---
apiVersion: metacontroller.k8s.io/v1alpha1
kind: CompositeController
metadata:
  name: hajimari-config
  labels:
    app.kubernetes.io/name: hajimari-config
    app.kubernetes.io/part-of: hajimari
spec:
  generateSelector: true
  parentResource:
    apiVersion: homelab.edgard.org/v1alpha1
    resource: hajimariconfigs
  childResources:
    - apiVersion: v1
      resource: configmaps
      updateStrategy:
        method: InPlace
  hooks:
    sync:
      webhook:
        service:
          name: hajimari-config-sync
          namespace: edge-services
          port: 80
        path: /sync
        timeout: 15s
