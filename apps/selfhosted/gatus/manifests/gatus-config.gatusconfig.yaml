---
apiVersion: homelab.edgard.org/v1alpha1
kind: GatusConfig
metadata:
  name: gatus-config
  namespace: selfhosted
spec:
  base:
    metrics: false
    ui:
      title: Homelab Status
      description: Real-time health for homelab services.
      header: Homelab
      dark-mode: true
      default-sort-by: group
    storage:
      type: sqlite
      path: /data/gatus.db
    connectivity:
      checker:
        target: 1.1.1.1:53
        interval: 30s
    alerting:
      n8n:
        webhook-url: https://n8n.edgard.org/webhook/alert-enricher
        title: Homelab Alert
        default-alert:
          enabled: true
          failure-threshold: 3
          success-threshold: 2
          send-on-resolved: true
          description: "Service health check failed"
    endpoints:
      - name: dns-edgard-google
        group: 01-dns
        url: 8.8.8.8
        dns:
          query-name: edgard.org
          query-type: A
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: n8n
      - name: dns-edgard-cloudflare
        group: 01-dns
        url: 1.1.1.1
        dns:
          query-name: edgard.org
          query-type: A
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: n8n
      - name: dns-edgard-quad9
        group: 01-dns
        url: 9.9.9.9
        dns:
          query-name: edgard.org
          query-type: A
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: n8n
      - name: ping-amazon
        group: 02-connectivity
        url: icmp://www.amazon.com
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: n8n
      - name: ping-google
        group: 02-connectivity
        url: icmp://www.google.com
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: n8n
      - name: ping-microsoft
        group: 02-connectivity
        url: icmp://www.microsoft.com
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: n8n
      - name: ping-cloudflare
        group: 02-connectivity
        url: icmp://www.cloudflare.com
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: n8n
      - name: ping-akamai
        group: 02-connectivity
        url: icmp://www.akamai.com
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: n8n
      - name: ping-fastly
        group: 02-connectivity
        url: icmp://www.fastly.com
        labels:
          namespace: network
          scope: external
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: n8n
