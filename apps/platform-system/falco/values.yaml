---
fullnameOverride: falco

driver:
  kind: modern_ebpf
  sysfsMountPath: /sys/kernel
  modernEbpf:
    sysfsMount: true

collectors:
  kubernetes:
    enabled: true
    collectorHostname: "" # use service default
  containerEngine:
    engines:
      containerd:
        enabled: true
        sockets:
          - "/run/containerd/containerd.sock"
      docker:
        enabled: false
      podman:
        enabled: false
      cri:
        enabled: false
      lxc:
        enabled: false
      libvirt_lxc:
        enabled: false
      bpm:
        enabled: false

falco:
  json_output: true
  priority: warning

metrics:
  enabled: true
  interval: 1m
  outputRule: false
  rulesCountersEnabled: true
  resourceUtilizationEnabled: true
  service:
    annotations:
      prometheus.io/scrape: "true"
      prometheus.io/port: "8765"
      prometheus.io/path: /metrics
