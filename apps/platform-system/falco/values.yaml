---
fullnameOverride: falco

controller:
  kind: deployment
  deployment:
    replicas: 1

driver:
  kind: modern_ebpf
  sysfsMountPath: /sys/kernel
  modernEbpf:
    sysfsMount: true

collectors:
  kubernetes:
    enabled: true
    collectorHostname: "" # use service default
  containerEngine:
    engines:
      containerd:
        enabled: true
        sockets:
          - "/run/containerd/containerd.sock"
      docker:
        enabled: false
      podman:
        enabled: false
      cri:
        enabled: false
      lxc:
        enabled: false
      libvirt_lxc:
        enabled: false
      bpm:
        enabled: false

falco:
  priority: warning
  json_output: true

# Remove control-plane tolerations so the control-plane taint blocks scheduling
tolerations: []

falcosidekick:
  enabled: true
  replicaCount: 1
  config:
    existingSecret: falco-falcosidekick-telegram
    telegram:
      minimumpriority: warning
