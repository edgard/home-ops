---
fullnameOverride: trivy-operator

operator:
  replicas: 1
  scanJobsConcurrentLimit: 1
  scanJobsRetryDelay: 30s
  vulnerabilityScannerScanOnlyCurrentRevisions: true
  configAuditScannerScanOnlyCurrentRevisions: true
  vulnerabilityScannerReportTTL: 24h # Daily rescan to catch new CVEs
  scanJobTTL: 30s
  scanSecretTTL: 30s
  excludeNamespaces: "kube-*,local-path-storage" # Skip all kube-* system namespaces we can't patch

trivy:
  severity: CRITICAL
  slow: true
  ignoreUnfixed: true # Skip vulns with no available fix

serviceMonitor:
  enabled: false

# Node selector for control plane exclusion
nodeSelector: {}
tolerations: []
