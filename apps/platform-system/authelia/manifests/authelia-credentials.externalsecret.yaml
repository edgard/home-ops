---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: authelia-credentials
  namespace: platform-system
spec:
  refreshInterval: 5m
  secretStoreRef:
    name: external-secrets-store
    kind: ClusterSecretStore
  target:
    name: authelia-credentials
    creationPolicy: Owner
    template:
      engineVersion: v2
      data:
        session.encryption.key: "{{ .authelia_session_secret }}"
        storage.encryption.key: "{{ .authelia_storage_encryption_key }}"
        identity_validation.reset_password.jwt.hmac.key: "{{ .authelia_jwt_secret }}"
        notifier.smtp.password.txt: "{{ .authelia_smtp_password }}"
  data:
    - secretKey: authelia_session_secret
      remoteRef:
        key: authelia_session_secret
    - secretKey: authelia_storage_encryption_key
      remoteRef:
        key: authelia_storage_encryption_key
    - secretKey: authelia_jwt_secret
      remoteRef:
        key: authelia_jwt_secret
    - secretKey: authelia_smtp_password
      remoteRef:
        key: authelia_smtp_password
