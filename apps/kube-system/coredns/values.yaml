---
controllers: {}

configMaps:
  # Create the custom ConfigMap that k3s CoreDNS automatically mounts
  custom:
    enabled: true
    forceRename: coredns-custom
    data:
      # Files ending in .override are imported INSIDE the main .:53 server block
      # This avoids memory overhead of a separate server block (prevents OOM)
      # Hairpin DNS: forward edgard.org queries to k8s-gateway which:
      # 1. Resolves HTTPRoute hostnames to gateway's internal ClusterIP
      # 2. Falls through to Unifi (192.168.1.1) for subdomains without HTTPRoutes
      edgard.override: |-
        forward edgard.org 10.43.53.53
