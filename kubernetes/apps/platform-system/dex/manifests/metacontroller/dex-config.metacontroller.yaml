---
apiVersion: metacontroller.k8s.io/v1alpha1
kind: CompositeController
metadata:
  name: dex-config
  labels:
    app.kubernetes.io/name: dex-config
    app.kubernetes.io/part-of: dex
spec:
  generateSelector: true
  parentResource:
    apiVersion: homelab.edgard.org/v1alpha1
    resource: dexconfigs
  childResources:
    - apiVersion: v1
      resource: configmaps
      updateStrategy:
        method: InPlace
  hooks:
    sync:
      webhook:
        service:
          name: dex-config-sync
          namespace: platform-system
          port: 80
        path: /sync
        timeout: 15s
